---
title: "p8105_mtp_sal2222"
author: "Stephen Lewandowski"
date: "October 26, 2018"
output: 
  github_document:
    toc: true
---


```{r setup, include = FALSE}

library(tidyverse)
library(readxl)
library(devtools)
library(patchwork) #devtools::install_github("thomasp85/patchwork")
library(wordcountaddin)
#devtools::install_github("benmarwick/wordcountaddin", type = "source", dependencies = TRUE)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_bw() + theme(legend.position = "bottom"))
```

### Introduction




### Accelerometer Dataset Description

The initial dataset consists of `r read_csv(file = "./data/p8105_mtp_data.csv") %>% nrow()` observations and `r read_csv(file = "./data/p8105_mtp_data.csv") %>% ncol()` variables. This dataset  includes separate activity count variables for each minute of the day. 

```{r load_activity_data, message = FALSE}

activity_df <- read_csv(file = "./data/p8105_mtp_data.csv") %>%
  janitor::clean_names() %>% 
  gather(key = daily_min, value = activity, activity_1:activity_1440) %>% 
  mutate(daily_min = str_replace(daily_min, "activity_", ""),
         daily_min = as.numeric(daily_min),
         day = ordered(day, levels = c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", 
"Friday", "Saturday"))) %>% 
  arrange(week, day, daily_min)

activity_df

```

After data wrangling, my resulting dataset consists of `r nrow(activity_df)` observations representing each minute and `r ncol(activity_df)` variables for week, day of week, minute of the day, and activity count score.  

A `skimr` skim review shows that there are no missing values for any of the variables, each day of the week appears 67,680 times, there are 47 weeks of data, and the mean activity count score is 240.34 with a range from 1 - 10,417.

A histogram view of activity counts indicates a very right-skewed distribution with a large peak at the baseline count value  of 1. A boxplot view illustrates a large number of extreme outliers. It is unclear whether these measurements are due to periods of more intense activity or are due to instrument error. An empirical cumulative distribution function (ECDF) plot of activity shows that the distribution curve approaches `1.00` at an activity count of approximately `2500`.  

The value `1` appears `r activity_df %>% filter(activity == 1) %>% summarize(n = n())` times, accounting for `r ((activity_df %>% filter(activity == 1) %>% summarize(n = n())) / (nrow(activity_df))) * 100` percent of all observations. At the upper end of the distribution, there are `r activity_df %>% filter(activity > 2500) %>% summarize(n = n())` observations above `2500`, `r activity_df %>% filter(activity > 5000) %>% summarize(n = n())` above `5000`, and `r activity_df %>% filter(activity > 7500) %>% summarize(n = n())` above `7500`. 

```{r}

ecdf_p <- activity_df %>% 
    ggplot(aes(x = activity)) +
    stat_ecdf(geom = "step") +
    labs(
    title = "Activity count empirical \ncumulative distribution function",
    x = "Activity count",
    y = "Cumulative density"
  )

hist_p <- activity_df %>% 
  filter(activity < 2500 & activity > 1) %>% 
  ggplot(aes(x = activity)) + 
  geom_histogram(bins = 200) +
  labs(
    title = "Activity count histogram \n(1 < Activity < 2500)",
    x = "Activity count",
    y = "Count"
  )

(ecdf_p + hist_p)

```



```{r exploratory_not_included, include = FALSE}
# Dataframe skimr
skimr::skim(activity_df)

# Activity boxplot
activity_df %>% 
   ggplot(aes(x = "activity", y = activity)) + 
   geom_boxplot()

```





### Activity over time

```{r total_daily_activity}

activity_df %>%
  group_by(week, day) %>% 
  summarize(daily_activity = sum(activity))


activity_df %>%
  group_by(week, day) %>% 
  summarize(daily_activity = sum(activity)) %>%
  ungroup() %>% 
  mutate(day_index = row_number()) %>% 
  ggplot(aes(x = day_index, y = daily_activity)) + 
  geom_point(aes(color = day), alpha = .5) + 
  labs(
    title = "Daily activity over time",
    x = "Indexed day",
    y = "Total daily activity count"
  ) + 
  viridis::scale_color_viridis(
    name = "Day of Week", 
    discrete = TRUE
  )
```

Explore the hypothesis that the participant became more active over time

### Day of week effect

```{r day_of_week_effect}

activity_df %>%
  group_by(day) %>% 
  summarize(dow_mean_activity = mean(activity),
            dow_median_activity = median(activity),
            dow_sd_activity = sd(activity))


```
Examine the possibility that day of the week affects activity (in isolation and in addition to the effect of time).



### Daily activity profiles

Make a visualization that shows the 24-hour activity “profiles” for each day. Also visualize effects of time and day of the week on 24-hour activity profiles; incorporating smooth estimates of mean activity profiles may clarify these effects. Comment on relationships you think are interesting.



```{r word count}
wordcountaddin::text_stats("p8105_mtp_sal2222.Rmd")
```

